repos:
  - repo: local
    hooks:
      - id: swift-test
        name: Swift Tests
        entry: swift test
        language: system
        pass_filenames: false
        always_run: true
        stages: [commit]
        
      - id: swift-format
        name: Swift Format
        entry: swift-format --in-place
        language: system
        files: \.swift$
        stages: [commit]
        
      - id: architecture-check
        name: Architecture Check
        entry: bash -c 'if [[ "$(uname -m)" != "arm64" ]]; then echo "Error: This project requires Apple Silicon (arm64)"; exit 1; fi'
        language: system
        pass_filenames: false
        always_run: true
        stages: [commit]
        
      - id: performance-check
        name: Performance Regression Check
        entry: swift test --filter PerformanceBenchmarks
        language: system
        pass_filenames: false
        stages: [commit]
        
      - id: memory-check
        name: Memory Leak Check
        entry: leaks --atExit -- swift test
        language: system
        pass_filenames: false
        stages: [push]
        
      - id: no-homebrew-name
        name: No Homebrew Name Check
        entry: bash -c 'if grep -r "Homebrew" Sources/ Tests/ --include="*.swift" | grep -v "// Attribution"; then echo "Error: Found 'Homebrew' in code. Use 'Velo' instead."; exit 1; fi'
        language: system
        pass_filenames: false
        always_run: true
        stages: [commit]